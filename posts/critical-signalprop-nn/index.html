<!DOCTYPE html><html class="font-serif scroll-smooth" lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,viewport-fit=cover" name=viewport><link href=/icons/godmode.png rel=icon type=image/png><title>Statistical physics of signal propagation in deep neural networks | Dhruva&#39;s dumb website</title><meta content="Using statistical physics to understand what makes a good activation function" name=description><meta content="Dhruva Karkada" name=author><meta content="Astro v5.9.3" name=generator><meta content="oklch(0.20 0.036 280)" name=theme-color><link href=https://fonts.googleapis.com rel=preconnect><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap&" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,200..900;1,200..900&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel=stylesheet><link href=/_astro/katex.min.COXD5gRV.css rel=preload as=style><link href=/_astro/photoswipe.cPPnkASS.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=/_astro/katex.min.COXD5gRV.css rel=stylesheet media=print onload="this.media=&#34;all&#34;"><link href=/rss.xml rel=alternate type=application/rss+xml title="RSS Feed"><link href=/atom.xml rel=alternate type=application/atom+xml title="Atom Feed"><link href=/sitemap-index.xml rel=sitemap><link href=https://dkarkada.xyz/posts/critical-signalprop-nn/ rel=canonical><meta content=article property=og:type><meta content=https://dkarkada.xyz/posts/critical-signalprop-nn/ property=og:url><meta content="Statistical physics of signal propagation in deep neural networks | Dhruva's dumb website" property=og:title><meta content="Using statistical physics to understand what makes a good activation function" property=og:description><meta content=https://dkarkada.xyz/og/blog/2022-12-07-stat-mech-signal-prop-nn.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=@dhruvakarkada name=twitter:site><meta content=true name=astro-view-transitions-enabled><meta content=none name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CLDwYp7M.js></script><script>!function(){function e(e=document){const t=function(){const e=localStorage.getItem("theme");return!e||"dark"===e}();e.documentElement.classList.toggle("dark",t);const n=e.head.querySelector('meta[name="theme-color"]');n?.setAttribute("content",t?"oklch(0.20 0.036 280)":"oklch(96% 0.005 298)")}function t(e=document){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("startViewTransition"in e);e.documentElement.classList.toggle("reduce-motion",t),e.documentElement.classList.add("js")}e(),t(),document.addEventListener("astro:before-swap",(({newDocument:n})=>{e(n),t(n)})),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(({matches:t})=>{localStorage.setItem("theme",t?"dark":"light"),e(),document.dispatchEvent(new Event("theme-changed"))}))}()</script><link href=/_astro/_index_.BiDrjJpm.css rel=stylesheet><link href=/_astro/_posts_slug_.xFqqKmxR.css rel=stylesheet><style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-new(*),::view-transition-old(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}</style><script type=module src=/_astro/page.BNYwb576.js></script><script>!function(t,e,n,r){(window.crossOriginIsolated||navigator.serviceWorker)&&((r=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(r[n]||[]).concat(["dataLayer.push","gtag"]))}(window,"partytown","forward");const t={preserveBehavior:!1},e=e=>{if("string"==typeof e)return[e,t];const[n,r=t]=e;return[n,{...t,...r}]},n=Object.freeze((()=>{const t=new Set;let e=[];do{Object.getOwnPropertyNames(e).forEach((n=>{"function"==typeof e[n]&&t.add(n)}))}while((e=Object.getPrototypeOf(e))!==Object.prototype);return Array.from(t)})());!function(t,r,o,i,a,s,c,d,l,p,u=t,f){function y(){f||(f=1,"/"==(c=(s.lib||"/~partytown/")+(s.debug?"debug/":""))[0]&&(l=r.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(d=setTimeout(h,(null==s?void 0:s.fallbackTimeout)||1e4),r.addEventListener("pt0",b),a?w(1):o.serviceWorker?o.serviceWorker.register(c+(s.swPath||"partytown-sw.js"),{scope:c}).then((function(t){t.active?w():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&w()}))}),console.error):h())))}function w(e){p=r.createElement(e?"script":"iframe"),t._pttab=Date.now(),e||(p.style.display="block",p.style.width="0",p.style.height="0",p.style.border="0",p.style.visibility="hidden",p.setAttribute("aria-hidden",!0)),p.src=c+"partytown-"+(e?"atomics.js?v=0.11.1":"sandbox-sw.html?"+t._pttab),r.querySelector(s.sandboxParent||"body").appendChild(p)}function h(n,o){for(b(),i==t&&(s.forward||[]).map((function(n){const[r]=e(n);delete t[r.split(".")[0]]})),n=0;n<l.length;n++)(o=r.createElement("script")).innerHTML=l[n].innerHTML,o.nonce=s.nonce,r.head.appendChild(o);p&&p.parentNode.removeChild(p)}function b(){clearTimeout(d)}s=t.partytown||{},i==t&&(s.forward||[]).map((function(r){const[o,{preserveBehavior:i}]=e(r);u=t,o.split(".").map((function(e,r,o){var a;u=u[o[r]]=r+1<o.length?u[o[r]]||(a=o[r+1],n.includes(a)?[]:{}):(()=>{let e=null;if(i){const{methodOrProperty:n,thisObject:r}=((t,e)=>{let n=t;for(let t=0;t<e.length-1;t+=1)n=n[e[t]];return{thisObject:n,methodOrProperty:e.length>0?n[e[e.length-1]]:void 0}})(t,o);"function"==typeof n&&(e=(...t)=>n.apply(r,...t))}return function(){let n;return e&&(n=e(arguments)),(t._ptf=t._ptf||[]).push(o,arguments),n}})()}))})),"complete"==r.readyState?y():(t.addEventListener("DOMContentLoaded",y),t.addEventListener("load",y))}(window,document,navigator,top,window.crossOriginIsolated),document.addEventListener("astro:before-swap",(t=>{let e=document.body.querySelector("iframe[src*='/~partytown/']");e&&t.newDocument.body.append(e)}))</script><style>[data-astro-transition-scope=astro-va26yt7w-1]{view-transition-name:post-critical-signalprop-nn}@layer astro{::view-transition-old(post-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(post-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(post-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(post-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-va26yt7w-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-va26yt7w-1]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style><style>[data-astro-transition-scope=astro-aqc54ihn-2]{view-transition-name:time-critical-signalprop-nn}@layer astro{::view-transition-old(time-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}::view-transition-new(time-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back]::view-transition-old(time-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back]::view-transition-new(time-critical-signalprop-nn){animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeOut}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-aqc54ihn-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-aqc54ihn-2]{animation-duration:180ms;animation-timing-function:cubic-bezier(0.76,0,0.24,1);animation-fill-mode:both;animation-name:astroFadeIn}</style></head><div id=noise-overlay></div><div class="relative w-full max-w-205.848 min-h-dvh min-h-vh mx-auto" lg="mx-[max(5.75rem,calc(50vw-34.25rem))] my-20 max-w-[min(calc(75vw-16rem),44rem)] min-h-full p-0" p="x-[min(7.25vw,3.731rem)] y-10"><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).load=async a=>{await(await a())()},window.dispatchEvent(new Event("astro:load"))</script><script>(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island await-children client=load component-export=default component-url=/_astro/Anim.OuElsjs2.js opts={&quot;name&quot;:&quot;Anim&quot;,&quot;value&quot;:true} prefix=r1 props={&quot;isAbout&quot;:[0,false],&quot;isHome&quot;:[0,false]} renderer-url=/_astro/client.BPIbHqJh.js ssr uid=2u3Au4><div class="animContainer lg:uno-desktop-column w-14em"><canvas class=animCanvas height=50 width=50></canvas></div><!--astro:end--></astro-island><nav aria-label="Site Navigation" class="hidden font-italic font-navbar font-semibold leading-2.45em lg:block lg:bottom-[min(9.04rem+3.85vw,10.5rem)] lg:text-5 lg:uno-desktop-column mb-10.5 text-3.6"><ul><li><a href=/ class="c-primary after:bottom-0.7em font-bold highlight-static">Posts</a></li><li><a href=/tags/ class="highlight-hover hover:c-primary after:bottom-0.7em hover:font-bold transition-[colors,font-weight]">Tags</a></li></ul></nav><main class=mb-12><article class="heti mb-12.6"><div class=relative><button aria-label="Go back" class=hidden id=back-button lg="absolute left--10 top-3.8 block aspect-square w-4.5 c-secondary/40 transition-colors ease-out hover:c-secondary/80 active:scale-90!"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d=M17.8.7L4,12l13.8,11.4.7-.9L7.2,12,18.5,1.5l-.7-.8Z /></svg></button><script type=module>function t(){document.getElementById("back-button")?.addEventListener("click",(()=>{window.history.length>1?window.history.back():document.getElementById("site-title-link")?.click()}))}t(),document.addEventListener("astro:after-swap",t)</script><h1 class=post-title><span data-astro-transition-scope=astro-va26yt7w-1 data-disable-theme-transition>Statistical physics of signal propagation in deep neural networks</span></h1></div><div class="c-primary block font-time mb-17.2" id=gsap-post-date data-astro-transition-scope=astro-aqc54ihn-2 data-disable-theme-transition><time datetime=2022-12-07>7 Dec 2022 </time><span class=ml-1.75>7 min</span></div><div class="2xl:bg-secondary/0 2xl:border-none 2xl:fixed 2xl:left-0 2xl:max-w-[min(calc(50vw-38rem),13rem)] 2xl:top-44.5 bg-secondary/5 mb-6 uno-round-border" data-astro-cid-v5otsao3 id=toc-container><input data-astro-cid-v5otsao3 hidden id=toc-toggle type=checkbox><div class="relative w-full h-12" data-astro-cid-v5otsao3><label class="flex absolute inset-0 items-center 2xl:c-secondary/40 2xl:ease-out 2xl:flex 2xl:hover:c-secondary/80 2xl:static 2xl:transition-colors cursor-pointer" data-astro-cid-v5otsao3 for=toc-toggle><span data-astro-cid-v5otsao3 id=toc-mobile-text>Table of Contents</span><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor class="hidden 2xl:active:scale-90! 2xl:block 2xl:mt-4 2xl:origin-center aspect-square ml-4 w-4.2" data-astro-cid-v5otsao3=true id=toc-desktop-icon><path d="M22.2 2.3H1.8V4h19.9zM22.2 20H1.8v1.7h19.9zM15.5 11.2H1.8v1.6H15z"/></svg></label></div><div id=toc-accordion-wrapper data-astro-cid-v5otsao3><nav aria-label="Table of Contents" data-astro-cid-v5otsao3 id=toc-accordion-content><ul data-astro-cid-v5otsao3 id=toc-links-list><li class=ml-0 data-astro-cid-v5otsao3><a href=#introduction class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>Introduction</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#field-theory-of-neural-networks class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>Field theory of neural networks</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#criticality-analysis class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>Criticality analysis</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#future-directions class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>Future directions</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#references class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>References</a></li><li class=ml-0 data-astro-cid-v5otsao3><a href=#footnote-label class="highlight-hover toc-links-h2" data-astro-cid-v5otsao3>Footnotes</a></li></ul></nav></div></div><script type=module>function g(){if(!(window.innerWidth>=1536))return;const t=document.getElementById("toc-accordion-content");if(!t)return;const e=t.getElementsByTagName("a");if(0===e.length)return;const n=Array.from(e,(t=>t)),o=n.some((t=>t.classList.contains("toc-links-h2")))?"toc-links-h2":"toc-links-h3",s=new Map;n.forEach((t=>{const e=t.getAttribute("href")?.substring(1);e&&s.set(e,t)}));let i=null;function c(t){t!==i&&(n.forEach((t=>{t.classList.remove("toc-link-active")})),t.classList.add("toc-link-active"),t.classList.contains(o)||function(t){for(let e=n.indexOf(t)-1;e>=0;e--){const t=n[e];if(t.classList.contains(o)){t.classList.add("toc-link-active");break}}}(t),i=t,t.scrollIntoView({behavior:"smooth",block:"nearest"}))}const r=new IntersectionObserver((t=>{const e=t.find((t=>t.isIntersecting))?.target?.id;if(e){const t=s.get(e);t&&c(t)}}),{rootMargin:"0% 0% -66% 0%",threshold:[.4]});Array.from(document.querySelectorAll("h2, h3, h4")).filter((t=>t.id&&"footnotes"!==t.id)).forEach((t=>r.observe(t))),n.length>0&&c(n[0]);const a=document.getElementById("gsap-post-content"),l=a?.lastElementChild;a&&l&&new IntersectionObserver((t=>{!t[0].isIntersecting&&t[0].boundingClientRect.top<0&&(n.forEach((t=>t.classList.remove("toc-link-active"))),i=null)}),{rootMargin:"0px 0px 0px 0px",threshold:0}).observe(l)}g(),document.addEventListener("astro:after-swap",g)</script><div id=gsap-post-content><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow></mrow><annotation encoding=application/x-tex>\newcommand{\E}[1]{\left\langle#1\right\rangle}</annotation></semantics></math></span><span class=katex-html aria-hidden=true></span></span></span><p>Here I’ve summarized some of the main ideas that underlie the theory of signal propagation in deep neural networks. This theory, which is strongly inspired by the physics of statistical field theory, explains the success of ReLU as an activation function for deep networks and also predicts that the Kaiming initialization scheme is optimal. I wrote this as a final report for a course on critical phenomena in equilibrium and nonequilibrium systems. I hope it’s informative!</p><h2 id=introduction>Introduction<a href=#introduction class=heading-anchor-link aria-label="Link to Introduction"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>In machine learning, we are interested in learning patterns in data. In regression problems, we focus on learning a function that uses data (e.g. a digital image) to predict properties of the data (e.g. whether the image contains a cat). To do this, we use a general-purpose function approximator: a neural network. A neural network (NN) parameterizes a family of functions by stacking <em>layers</em> of interleaved affine transformations and element-wise nonlinear transformations. For example,</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo stretchy=false>)</mo><mo>=</mo><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mi>L</mi><mo stretchy=false>)</mo></mrow></msup><mi>ϕ</mi><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mi>L</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mi>ϕ</mi><mo>…</mo><mi>ϕ</mi><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mover accent=true><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>f(\vec{x}) = \boldsymbol{A}^{(L)} \phi \boldsymbol{A}^{(L-1)}\phi\dots \phi \boldsymbol{A}^{(1)} \vec{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.1584em;vertical-align:-.1944em></span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mathnormal mtight">L</span><span class="mtight mbin">−</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">ϕ</span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(\vec{x})</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.10764em>f</span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> is the NN output on input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.714em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span>and the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>\boldsymbol{A}^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.964em></span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span> are affine transformations each defined by tunable (i.e. trainable) parameters. The index <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>ℓ</mi></mrow><annotation encoding=application/x-tex>\ell</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord>ℓ</span></span></span></span> enumerates the layers, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">L</span></span></span></span> is the <em>depth</em> of the neural network, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\phi(x_i)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> is a nonlinear scalar function which acts element-wise on a vector. Choosing <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">L</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span> is a design decision made a priori. When we train this NN, we tune its affine parameters to search the family of functions for a specific function that well-approximates the true pattern in the data. Training is computationally expensive, so we would like to use theoretical principles to guide design decisions and maximize performance.</p><p>Unfortunately, we lack a complete theory that predicts the final performance of a given NN before actually training it. The fundamental difficulty is that neural networks may have billions of parameters whose training dynamics are coupled. This justifies using tools from statistical physics to uncover the basic behaviors and properties of these large-scale systems. In fact, mean field theory, partition functions, replica calculations, phase transitions, and more have become standard in NN theory, reflecting a long history of contributions from statistical physicists to NN theory (<a href=https://www.annualreviews.org/doi/abs/10.1146/annurev-conmatphys-031119-050745 rel="nofollow noopener noreferrer external" target=_blank>Bahri et al. 2020</a>).</p><p>In the past decade, practitioners have provided evidence that deeper neural networks a) perform better, but b) are more challenging to optimize. Subsequent work empirically found that a particular choice of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span> known as ReLU helped alleviate the optimization challenge of deep neural networks (<a href=https://arxiv.org/abs/1502.01852 rel="nofollow noopener noreferrer external" target=_blank>He et al. 2015</a>). All of these observations lacked theoretical explanations for many years. In this report, I will summarize recent results that use statistical field theory to convincingly explain these phenomena.</p><h2 id=field-theory-of-neural-networks>Field theory of neural networks<a href=#field-theory-of-neural-networks class=heading-anchor-link aria-label="Link to Field theory of neural networks"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>In a trained neural network, we expect that two input vectors that are semantically similar (e.g. that both are images of cats) should be pushed towards each other as the input propagates through the network. In this sense, the role of a neural network is to extract semantic structure from the relevant data, which is typically some complicated submanifold in input space (i.e. a ‘typical’ random vector in image space is just noise; we only care about the manifold of ‘natural’ images).</p><p>Of course, the way an input is transformed through the network depends on the affine parameters. While the optimization algorithm provides the dynamical equation for the parameters, we must also specify the initial conditions. In practice, affine parameters are initialized i.i.d. Gaussian as</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msubsup><mi>W</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo>∼</mo><mi mathvariant=script>N</mi><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mi mathvariant=normal>/</mi><mi>N</mi><mo stretchy=false>)</mo><mspace width=1em></mspace><mrow><mi mathvariant=normal>a</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>d</mi></mrow><mspace width=1em></mspace><msubsup><mi>b</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo>∼</mo><mi mathvariant=script>N</mi><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>W^{(\ell)}_{ij}\sim \mathcal{N}(0, \sigma_w^2/N) \quad\mathrm{and}\quad b^{(\ell)}_i \sim \mathcal{N}(0, \sigma_b^2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.4578em;vertical-align:-.413em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.1389em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.05724em>ij</span></span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.413em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∼</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.3217em;vertical-align:-.2769em></span><span class="mord mathcal" style=margin-right:.14736em>N</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mord>/</span><span class="mord mathnormal" style=margin-right:.10903em>N</span><span class=mclose>)</span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathrm">and</span></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∼</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.1141em;vertical-align:-.25em></span><span class="mord mathcal" style=margin-right:.14736em>N</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><mover accent=true><mi>v</mi><mo>⃗</mo></mover><mo stretchy=false>)</mo><mo>=</mo><msup><mi mathvariant=bold-italic>W</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup><mover accent=true><mi>v</mi><mo>⃗</mo></mover><mo>+</mo><msup><mover accent=true><mi>b</mi><mo>⃗</mo></mover><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>\boldsymbol{A}^{(\ell)}(\vec{v})=\boldsymbol{W}^{(\ell)}\vec{v}+\vec{b}^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.214em;vertical-align:-.25em></span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.0473em;vertical-align:-.0833em></span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol" style=margin-right:.15972em>W</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.03588em>v</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.9774em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">b</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>N</mi></mrow><annotation encoding=application/x-tex>N</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span></span></span></span> is the dimension of the affine input. The parameter variances <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup></mrow><annotation encoding=application/x-tex>\sigma_b^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0972em;vertical-align:-.2831em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.4169em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831em><span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup></mrow><annotation encoding=application/x-tex>\sigma_w^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0611em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span> must be chosen carefully a priori; <a href=https://arxiv.org/abs/1502.01852 rel="nofollow noopener noreferrer external" target=_blank>He et al. (2015)</a> suggest choosing <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>\sigma_w^2=2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0611em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>2</span></span></span></span>, which is now standard due to its empirical success. Now, as in statistical physics, we study the resulting ensemble of neural networks. In particular, we characterize a neural network’s manipulation of the data manifold by studying the inner product between two arbitrary inputs as they are processed layer-by-layer:</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msubsup><mi>G</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo stretchy=false>(</mo><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo separator=true>,</mo><msup><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup><mo stretchy=false>)</mo><mo>:</mo><mo>=</mo><mrow><mo fence=true>⟨</mo><msubsup><mi>z</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo stretchy=false>(</mo><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo stretchy=false>)</mo><msubsup><mi>z</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo stretchy=false>(</mo><msup><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup><mo stretchy=false>)</mo><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>\newcommand{\E}[1]{\left\langle#1\right\rangle} G_{i}^{(\ell)}(\vec{x}, \vec{x}') := \E{z_i^{(\ell)}(\vec{x}) z_i^{(\ell)}(\vec{x}')}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3217em;vertical-align:-.2769em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8019em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>:=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.8em;vertical-align:-.65em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">⟨</span></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8019em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose>)</span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">⟩</span></span></span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mover accent=true><mi>z</mi><mo>⃗</mo></mover><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\vec{z}^{(\ell)}(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.138em;vertical-align:-.25em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1799em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span> is the output<sup><a href=#user-content-fn-1 aria-describedby=footnote-label data-footnote-ref="" id=user-content-fnref-1>1</a></sup> of layer <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>ℓ</mi></mrow><annotation encoding=application/x-tex>\ell</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord>ℓ</span></span></span></span> on input <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>x</mi></mrow><annotation encoding=application/x-tex>x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">x</span></span></span></span>, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> is a vector component index (dropped later for clarity). The expectation is over the network ensemble. The quantity <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">G</span></span></span></span> characterizes the changing geometry of the data manifold as it propagates through the network ensemble.</p><p>Note that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">G</span></span></span></span> is precisely the two-point correlator of layer outputs (<a href=https://doi.org/10.1017/CBO9780511815881 rel="nofollow noopener noreferrer external" target=_blank>Kardar 2007</a>). So, we can restate our goal as characterizing the correlator’s flow from layer to layer. If we want neural networks to preserve important structural information about the input as it flows to deep layers, then we must ensure that the correlator is flow-invariant: in other words, we need to initialize the NN at criticality, so that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup><mo>∼</mo><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mn>0</mn><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>G^{(\ell)}\sim G^{(0)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.888em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∼</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.888em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">0</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span> for all <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>ℓ</mi></mrow><annotation encoding=application/x-tex>\ell</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord>ℓ</span></span></span></span>. A very deep network initialized far from criticality will yield outputs uncorrelated to the input, and the optimization algorithm will therefore fail (<a href=https://arxiv.org/abs/1611.01232 rel="nofollow noopener noreferrer external" target=_blank>Schoenholz et al. 2016</a>).</p><p>However, a major challenge remains. Although the first-layer “field” <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>z</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msubsup></mrow><annotation encoding=application/x-tex>z_i^{(1)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3217em;vertical-align:-.2769em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span></span></span></span> is Gaussian-distributed, as <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>z</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup></mrow><annotation encoding=application/x-tex>z_i^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3217em;vertical-align:-.2769em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span></span></span></span> flows along increasing <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>ℓ</mi></mrow><annotation encoding=application/x-tex>\ell</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6944em></span><span class=mord>ℓ</span></span></span></span>, its ensemble distribution increasingly deviates from Gaussianity<sup><a href=#user-content-fn-2 aria-describedby=footnote-label data-footnote-ref="" id=user-content-fnref-2>2</a></sup>. This makes theoretical analysis intractable (<a href=https://arxiv.org/abs/2106.10165 rel="nofollow noopener noreferrer external" target=_blank>Roberts, Yaida, and Hanin 2022</a>). To circumvent this, we take the “infinite-width limit”: we take the dimension of the codomains of all <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi mathvariant=bold-italic>A</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo>&#x3C;</mo><mi>L</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>\boldsymbol{A}^{(\ell&#x3C;L)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.964em></span><span class=mord><span class=mord><span class=mord><span class="mord boldsymbol">A</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.964em><span style=top:-3.139em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mrel">&#x3C;</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span> to infinity, so that all the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mover accent=true><mi>z</mi><mo>⃗</mo></mover><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo>&#x3C;</mo><mi>L</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>\vec{z}^{(\ell&#x3C;L)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.888em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.04398em>z</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1799em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mrel">&#x3C;</span><span class="mord mathnormal mtight">L</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span> are infinite-dimensional. It turns out that ensemble fluctuations of the correlator vanish in this limit. In this mean-field limit, the output fields <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>z</mi><mi>i</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup></mrow><annotation encoding=application/x-tex>z_i^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.3217em;vertical-align:-.2769em></span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4231em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2769em><span></span></span></span></span></span></span></span></span></span> are zero-mean Gaussian random fields and are thus fully characterized by the correlator <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>G^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.888em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span>.</p><p>This field-theoretic framework allows us to theoretically compute the correlator for a variety of choices of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span>, provides a criterion for criticality, and relates these to the geometry of the data manifold and the trainability of the NN.</p><h2 id=criticality-analysis>Criticality analysis<a href=#criticality-analysis class=heading-anchor-link aria-label="Link to Criticality analysis"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>For a NN to be initialized at criticality, we need the correlator to approach a nontrivial fixed point <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi mathvariant=normal>ℓ</mi><mo>→</mo><mi mathvariant=normal>∞</mi></mrow></msub><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup><mo>=</mo><msup><mi>G</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>\lim_{\ell\to\infty}G^{(\ell)}=G^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.038em;vertical-align:-.15em></span><span class=mop><span class=mop>lim</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=top:-2.55em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mtight mrel">→</span><span class="mord mtight">∞</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">∗</span></span></span></span></span></span></span></span></span></span></span>. This will depend on the choice of the nonlinearity <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span> as well as the initial parameter variances <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup></mrow><annotation encoding=application/x-tex>\sigma_b^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0972em;vertical-align:-.2831em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.4169em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831em><span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup></mrow><annotation encoding=application/x-tex>\sigma_w^2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0611em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span>. In the infinite-width (mean-field) limit, we obtain the recursive flow relation</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mo stretchy=false>(</mo><msub><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo>+</mo></msub><mo separator=true>,</mo><msub><mover accent=true><mi>x</mi><mo>⃗</mo></mover><mo>−</mo></msub><mo stretchy=false>)</mo><mo>=</mo><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mrow><mo fence=true>⟨</mo><mi>ϕ</mi><mo stretchy=false>(</mo><msubsup><mi>z</mi><mo>+</mo><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo stretchy=false>)</mo><mi>ϕ</mi><mo stretchy=false>(</mo><msubsup><mi>z</mi><mo>−</mo><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msubsup><mo stretchy=false>)</mo><mo fence=true>⟩</mo></mrow></mrow><annotation encoding=application/x-tex>\newcommand{\E}[1]{\left\langle#1\right\rangle} G^{(\ell+1)}(\vec{x}_+, \vec{x}_-) =\sigma_b^2 + \sigma_w^2\E{\phi(z_+^{(\ell)}) \phi(z_-^{(\ell)})}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mbin">+</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2583em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2083em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">x</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2077em><span class=overlay style=height:.714em;width:.471em><svg viewBox="0 0 471 714" height=0.714em preserveAspectRatio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2583em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2083em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.1111em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1.8em;vertical-align:-.65em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">⟨</span></span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4765em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">+</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.0448em><span style=top:-2.4765em;margin-left:-.044em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">−</span></span></span><span style=top:-3.2198em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">⟩</span></span></span></span></span></span></span><p>where the expectation is tractable in the mean-field limit since it depends only on <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>G</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>G^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.888em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.888em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span>.</p><p><a href=https://arxiv.org/abs/2106.10165 rel="nofollow noopener noreferrer external" target=_blank>Roberts, Yaida, and Hanin (2022)</a> use perturbative techniques to compute the fixed point <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>G</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>G^*</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6887em></span><span class=mord><span class="mord mathnormal">G</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6887em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">∗</span></span></span></span></span></span></span></span></span></span></span> for nonlinearities obeying <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi><mo stretchy=false>(</mo><mi>λ</mi><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>λ</mi><mi>ϕ</mi><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\phi(\lambda x)=\lambda\phi(x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class="mord mathnormal">λ</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">λ</span><span class="mord mathnormal">ϕ</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span>, which include the ubiquitous <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>R</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>L</mi><mi mathvariant=normal>U</mi></mrow><mo stretchy=false>(</mo><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\mathrm{ReLU}(x)=\max(0,x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathrm">ReLU</span></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mop>max</span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span>. By linearizing the flow equation around the degenerate limit where both inputs coincide identically, i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>x</mi><mo>±</mo></msub><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo>±</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>δ</mi><mi>x</mi></mrow><annotation encoding=application/x-tex>x_\pm = x_0\pm\frac{1}{2}\delta x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6389em;vertical-align:-.2083em></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2583em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mtight mbin">±</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2083em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.7333em;vertical-align:-.15em></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=top:-2.55em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>±</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1.1901em;vertical-align:-.345em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8451em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class="mord mathnormal">x</span></span></span></span>, they find a flow in the correlator perturbation, which can be solved to low order in the perturbation. For <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>R</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>L</mi><mi mathvariant=normal>U</mi></mrow><annotation encoding=application/x-tex>\mathrm{ReLU}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class=mord><span class="mord mathrm">ReLU</span></span></span></span></span>:</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mo stretchy=false>(</mo><mi>G</mi><mo>+</mo><mi>δ</mi><mi>G</mi><msup><mo stretchy=false>)</mo><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></msup><mo>=</mo><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mo stretchy=false>(</mo><mi>G</mi><mo>+</mo><mi>δ</mi><mi>G</mi><msup><mo stretchy=false>)</mo><mrow><mo stretchy=false>(</mo><mi mathvariant=normal>ℓ</mi><mo stretchy=false>)</mo></mrow></msup></mrow><annotation encoding=application/x-tex>(G+\delta G)^{(\ell+1)} = \sigma_b^2+\frac{1}{2}\sigma_w^2(G+\delta G)^{(\ell)}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathnormal">G</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class="mord mathnormal">G</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mbin">+</span><span class="mord mtight">1</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1.1111em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:2.0074em;vertical-align:-.686em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">G</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:1.188em;vertical-align:-.25em></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class="mord mathnormal">G</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.938em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight"><span class="mtight mopen">(</span><span class="mord mtight">ℓ</span><span class="mtight mclose">)</span></span></span></span></span></span></span></span></span></span></span></span></span><p>which has a fixed point at <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup><mo separator=true>,</mo><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mn>0</mn><mo separator=true>,</mo><mn>2</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\sigma_b^2, \sigma_w^2)=(0, 2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0972em;vertical-align:-.2831em></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.4169em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>2</span><span class=mclose>)</span></span></span></span>. The theory also predicts a semi-critical fixed line at <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>b</mi><mn>2</mn></msubsup><mo>></mo><mn>0</mn></mrow><annotation encoding=application/x-tex>\sigma_b^2>0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0972em;vertical-align:-.2831em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.4169em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight">b</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>\sigma_w^2=2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0611em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>2</span></span></span></span>, where the total correlator increases linearly but the correlator perturbations are at a fixed point. If the NN is initialized on a (semi)critical point, information about the geometric structure of the data can propagate through arbitrarily deep networks without exponentially vanishing or blowing up. As a result, these initialization schemes greatly enhance the trainability of very deep networks, which is exactly what is observed in practice:</p><figure><img alt="Post-training performance on the MNIST dataset for ReLU networks, as a function of hyperparameters. As depth increases, criticality increasingly determines trainability, and the semicritical phase boundary becomes apparent. Figure adapted from Lee et al. 2017." decoding=async height=1027 loading=lazy src=/_astro/statphys-nn-phasediagram.AVmNh0Z1_2ltM85.webp width=1147><figcaption>Post-training performance on the MNIST dataset for ReLU networks, as a function of hyperparameters. As depth increases, criticality increasingly determines trainability, and the semicritical phase boundary becomes apparent. Figure adapted from Lee et al. 2017.</figcaption></figure><p>We can use this formalism to repeat this calculation for other choices of nonlinearity <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span>. The result is that there exists a broad class of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal">ϕ</span></span></span></span> which do not permit a fixed point. Deep networks with these nonlinearities are not trainable. The takeaway is that the theory predicts both the unique success of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>R</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>L</mi><mi mathvariant=normal>U</mi></mrow><annotation encoding=application/x-tex>\mathrm{ReLU}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.6833em></span><span class=mord><span class="mord mathrm">ReLU</span></span></span></span></span> as well as the Kaiming initialization scheme (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>σ</mi><mi>w</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding=application/x-tex>\sigma^2_w=2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0611em;vertical-align:-.247em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141em><span style=top:-2.453em;margin-left:-.0359em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="mtight reset-size6 size3 sizing"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>2</span></span></span></span>) which is widely used in practice.</p><h2 id=future-directions>Future directions<a href=#future-directions class=heading-anchor-link aria-label="Link to Future directions"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><p>Do NNs far from the mean-field limit behave qualitatively differently? Can the field theory framework handle task-specific NN architectures where the affine transforms may have additional structure? Can we go beyond initialization and make quantitative, data-dependent predictions about training dynamics? The field theory formalism presented here is one of many frameworks used to approach the slew of open questions remaining in NN theory. Rapid engineering improvements only deepen the gap between theory and practice; it will take a coherent synthesis of varying perspectives to develop a complete theory of deep learning.</p><h2 id=references>References<a href=#references class=heading-anchor-link aria-label="Link to References"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><ol><li><a href=https://www.annualreviews.org/doi/abs/10.1146/annurev-conmatphys-031119-050745 rel="nofollow noopener noreferrer external" target=_blank>Bahri, Yasaman et al. (2020). “Statistical mechanics of deep learning”. In: <em>Annual Review of Condensed Matter Physics</em> 11.1.</a></li><li><a href=https://arxiv.org/abs/1502.01852 rel="nofollow noopener noreferrer external" target=_blank>He, Kaiming et al. (2015). “Delving deep into rectifiers: Surpassing human-level performance on imagenet classification”. In: <em>Proceedings of the IEEE international conference on computer vision</em>, pp. 1026–1034.</a></li><li><a href=https://doi.org/10.1017/CBO9780511815881 rel="nofollow noopener noreferrer external" target=_blank>Kardar, Mehran (2007). <em>Statistical physics of fields</em>. Cambridge University Press.</a></li><li><a href=https://arxiv.org/abs/1611.01232 rel="nofollow noopener noreferrer external" target=_blank>Schoenholz, Samuel S et al. (2016). “Deep information propagation”. In: <em>arXiv preprint arXiv<div></div>.01232</em>.</a></li><li><a href=https://arxiv.org/abs/2106.10165 rel="nofollow noopener noreferrer external" target=_blank>Roberts, Daniel A, Sho Yaida, and Boris Hanin (2022). <em>The Principles of Deep Learning Theory: An Effective Theory Approach to Understanding Neural Networks</em>. Cambridge University Press.</a></li><li><a href=https://arxiv.org/abs/1711.00165 rel="nofollow noopener noreferrer external" target=_blank>Lee, Jaehoon et al. (2017). “Deep neural networks as gaussian processes”. In: <em>arXiv preprint arXiv<div></div>.00165</em>.</a></li></ol><section class=footnotes data-footnotes=""><h2 id=footnote-label class=sr-only>Footnotes<a href=#footnote-label class=heading-anchor-link aria-label="Link to Footnotes"><svg viewBox="0 0 24 24" aria-hidden=true fill=currentColor><path d="M2.6 21.4c2 2 5.9 2.9 8.9 0l3.5-3.5-1-1-3.5 3.5c-1.4 1.4-4.2 1.9-6.4-.3s-1.8-5-.3-6.4l3.5-3.5-1-1-3.5 3.5c-3 3-2 6.9 0 8.9ZM21.4 2.6c2 2 2.9 5.9 0 8.9L17.9 15l-1-1 3.5-3.5c1.4-1.4 1.9-4.2-.3-6.4s-5-1.8-6.4-.3l-3.5 3.5-1-1 3.5-3.5c3-3 6.9-2 8.9 0Z"></path><path d="m8.01 14.97 6.93-6.93 1.061 1.06-6.93 6.93z"></path></svg></a></h2><ol><li id=user-content-fn-1><p>This is the output just before the nonlinearity is applied. <a href=#user-content-fnref-1 class=data-footnote-backref aria-label="Back to reference 1" data-footnote-backref="">↩</a></p></li><li id=user-content-fn-2><p>The non-Gaussianity originates from “interactions” between field components that breaks their statistical independence. <a href=#user-content-fnref-2 class=data-footnote-backref aria-label="Back to reference 2" data-footnote-backref="">↩</a></p></li></ol></section></div></article><div id=gsap-post-tags><div class=uno-decorative-line></div><div class="flex flex-wrap gap-x-3 gap-y-3.2"><a href=/tags/tutorial/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">tutorial </span><span class="font-medium inline-block opacity-0" aria-hidden=true>tutorial </span></a><a href=/tags/science/ class="hover:c-primary border border-secondary/25 ease-out hover:border-secondary/80 hover:font-medium hover:ring-0.2 inline-block px-3.2 py-0.7 relative ring-0 ring-secondary/80 rounded-full transition-[colors,box-shadow]"><span class="flex absolute inset-0 items-center justify-center transition-font-weight whitespace-nowrap">science </span><span class="font-medium inline-block opacity-0" aria-hidden=true>science</span></a></div></div></main><footer class="font-navbar leading-1.25em lg:text-3.5 text-3" lg="uno-desktop-column bottom-20"><p><a href=https://github.com/dkarkada class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>GitHub</a>&nbsp;/ <a href=mailto:dkarkada@berkeley.edu class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Email</a>&nbsp;/ <a href=https://x.com/dhruvakarkada class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>X</a>&nbsp;</p><p>© 2025 Dhruva Karkada</p><p>Powered by <a href=https://astro.build/ class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Astro</a> and <a href=https://github.com/radishzzz/astro-theme-retypeset class="highlight-hover hover:c-primary after:bottom-0.35em py-0.8 transition-colors" rel="noopener noreferrer" target=_blank>Retypeset</a></p></footer></div><script type=module src=/_astro/GsapAnimation.astro_astro_type_script_index_0_lang.D3crq355.js></script><script>const SOUND_TYPES={CLICK:"tap",TYPING:"type"},CLICK_TARGETS=["#language-switcher","#theme-toggle-button"],TYPING_TARGETS=["#wl-nick","#wl-mail","#wl-link","#wl-edit"],IGNORED_KEYS=["Shift","Control","Alt","Meta","Tab","Escape","CapsLock"],CLICK_SELECTOR=CLICK_TARGETS.join(","),TYPING_SELECTOR=TYPING_TARGETS.join(",");class SoundEffectManager{constructor(){this.audioContext=null,this.audioBuffers=new Map,this.isReady=!1,this.isInitializing=!1}async initialize(){if(!this.isReady&&!this.isInitializing){this.isInitializing=!0;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),await this.preloadAllSounds(),this.isReady=!0}catch(t){console.warn("Audio initialization failed:",t)}finally{this.isInitializing=!1}}}async preloadAllSounds(){const t=Object.values(SOUND_TYPES).flatMap((t=>Array.from({length:5},((e,i)=>this.loadSound(`${t}_0${i+1}`,`/sounds/${t}_0${i+1}.wav`)))));await Promise.allSettled(t)}async loadSound(t,e){try{const i=await fetch(e),a=await i.arrayBuffer(),n=await this.audioContext.decodeAudioData(a);this.audioBuffers.set(t,n)}catch(e){console.warn(`Failed to load ${t}:`,e)}}async playSound(t){if(this.isReady||this.isInitializing||await this.initialize(),this.isReady&&this.audioContext&&0!==this.audioBuffers.size)try{"suspended"===this.audioContext.state&&await this.audioContext.resume();const e=Array.from(this.audioBuffers.entries()).filter((([e])=>e.startsWith(t))).map((([,t])=>t));if(0===e.length)return;const i=e[Math.floor(Math.random()*e.length)],a=this.audioContext.createBufferSource();a.buffer=i;const n=this.audioContext.createGain();n.gain.value=t===SOUND_TYPES.TYPING?.4:.8,a.connect(n),n.connect(this.audioContext.destination),a.start(0)}catch(t){console.warn("Playback failed:",t)}}}const soundManager=new SoundEffectManager;function handleGlobalClick(t){t.target.closest(CLICK_SELECTOR)&&soundManager.playSound(SOUND_TYPES.CLICK)}function handleGlobalKeydown(t){!t.target.closest(TYPING_SELECTOR)||t.ctrlKey||t.altKey||t.metaKey||IGNORED_KEYS.includes(t.key)||soundManager.playSound(SOUND_TYPES.TYPING)}function setupSoundSystem(){window.matchMedia("(max-width: 1023px)").matches||(document.removeEventListener("click",handleGlobalClick),document.removeEventListener("keydown",handleGlobalKeydown),document.addEventListener("click",handleGlobalClick),document.addEventListener("keydown",handleGlobalKeydown))}setupSoundSystem(),document.addEventListener("astro:page-load",setupSoundSystem)</script><script type=module>const s={copy:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="M6.9.8v18h14.5V.8zm12.8 16h-11v-14h11z"/>\n      <path d="M4.3 21.2V5.6l-1.7.5v17.1h14.3l.6-2z"/>\n    </svg>',success:'<svg\n      viewBox="0 0 24 24"\n      fill="currentColor"\n    >\n      <path d="m23.1 6.4-1.3-1.3L9.4 16.6l-6.3-5.4-1.2 1.2L9.4 20z"/>\n    </svg>'},c=new WeakMap;async function a(e){const t=e.parentElement?.querySelector("pre code");if(!t)return;const n=t.textContent??"";if(n)try{await navigator.clipboard.writeText(n);const t=c.get(e);t&&clearTimeout(t),e.innerHTML=s.success,e.classList.add("copy-success");const o=setTimeout((()=>{e.innerHTML=s.copy,e.classList.remove("copy-success"),c.delete(e)}),1500);c.set(e,o)}catch(e){console.error("Failed to copy code",e?.message??String(e))}}function n(){document.querySelectorAll(".code-copy-button:not([data-initialized])").forEach((e=>{e.innerHTML=s.copy,e.setAttribute("data-initialized","true")}))}document.addEventListener("click",(e=>{if(!(e.target instanceof HTMLElement))return;const t=e.target.closest(".code-copy-button");t&&a(t)}),{passive:!0}),n(),document.addEventListener("astro:page-load",n)</script><script type=module src=/_astro/PhotoSwipe.astro_astro_type_script_index_0_lang.DvZO34Rg.js></script><script type=module>async function m(t){const e=t.dataset.repo;if(!e)return;const n=t.getElementsByClassName("gc-owner-avatar")[0],o=t.getElementsByClassName("gc-repo-description")[0],a=t.getElementsByClassName("gc-stars-count")[0],r=t.getElementsByClassName("gc-forks-count")[0],s=t.getElementsByClassName("gc-license-info")[0];try{const t=await fetch(`https://api.github.com/repos/${e}`);if(!t.ok)return void(o&&(o.textContent="Loading failed."));const c=await t.json();n&&c.owner?.avatar_url&&(n.style.backgroundImage=`url(${c.owner.avatar_url})`),o&&(o.textContent=c.description??"No description"),a&&(a.textContent=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(c.stargazers_count??0)),r&&(r.textContent=new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(c.forks_count??0)),s&&(s.textContent=c.license?.spdx_id??"No License")}catch(t){console.error(`Failed to fetch ${e}:`,t?.message??String(t))}}function l(){const t=document.getElementsByClassName("gc-container");if(0===t.length)return;const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(m(t.target),e.unobserve(t.target))}))}),{rootMargin:"200px"});Array.from(t).forEach((t=>e.observe(t)))}l(),document.addEventListener("astro:page-load",l)</script></html>